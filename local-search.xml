<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hexo Fluid 实现文章过期提示（非侵入式方案）</title>
    <link href="/posts/1b963265/"/>
    <url>/posts/1b963265/</url>
    
    <content type="html"><![CDATA[<p>在维护博客时，经常会遇到一个问题：<strong>一些早期文章在搜索引擎或首页依然能被访问，但其中的内容已经不完全适用于当前环境。</strong></p><p>于是决定给这些文章一个 <strong>「过期提示」</strong></p><p>本文记录一种 <strong>完全非侵入式</strong> 的实现方案</p><h2 id="一、实现效果"><a href="#一、实现效果" class="headerlink" title="一、实现效果"></a>一、实现效果</h2><p>当文章满足条件时，在正文顶部显示提示：</p>  <div class="post-expired-warning">    这是一篇发布于    <strong>x 年 x 天</strong>    前的文章，部分信息可能已发生改变，请注意甄别。  </div><p>特性包括：</p><ul><li>不到 1 年显示：<code>X 天</code>, 超过 1 年显示：<code>X 年 X 天</code></li><li>可手动或按日期自动触发</li><li>不影响 Fluid 升级  </li><li>单篇文章控制</li></ul><h2 id="二、方案说明"><a href="#二、方案说明" class="headerlink" title="二、方案说明"></a>二、方案说明</h2><p>Fluid 提供了官方的 <strong>主题注入（theme_inject）机制</strong>，允许在不修改主题文件的前提下，将自定义内容插入到指定位置。</p><p>整体思路如下：</p><ol><li>使用 <code>scripts/</code> 注册注入位置  </li><li>将过期提示写成独立的 EJS 模板  </li><li>从文章 front-matter 中读取 <code>date / expired / expire_date</code>  </li><li>构建时自动计算并渲染</li></ol><p>整个过程 <strong>不接触 <code>themes/fluid</code> 目录</strong>，升级安全。</p><h2 id="三、文章-Front-matter-用法"><a href="#三、文章-Front-matter-用法" class="headerlink" title="三、文章 Front-matter 用法"></a>三、文章 Front-matter 用法</h2><p>在需要控制的文章中添加字段：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">---<br>title: 示例文章<br>date: 2023-02-10 12:28:33<br>expired: true (可选，默认为false)<br>expire_date: 2024-01-01 (可选)<br>---<br></code></pre></td></tr></table></figure><h3 id="字段说明"><a href="#字段说明" class="headerlink" title="字段说明"></a>字段说明</h3><ul><li><code>date</code>:文章发布时间（Hexo 默认字段），用于计算“距今多久”。</li><li><code>expired: true</code>:强制显示过期提示，不受日期影响。</li><li><code>expire_date</code>:指定一个过期时间，当当前时间晚于该日期时自动显示提示。</li></ul><h4 id="使用策略示例"><a href="#使用策略示例" class="headerlink" title="使用策略示例"></a>使用策略示例</h4><table><thead><tr><th>写法</th><th>行为</th></tr></thead><tbody><tr><td>什么都不写</td><td>永不显示</td></tr><tr><td><code>expired: true</code></td><td>强制显示</td></tr><tr><td>仅写 <code>expire_date</code></td><td>到期后显示</td></tr></tbody></table><h2 id="四、实现"><a href="#四、实现" class="headerlink" title="四、实现"></a>四、实现</h2><p>在根目录下，新建<code>scripts</code>目录（如果尚不存在）。</p><p>在该目录中创建一个用于注册注入的脚本文件<code>inject-expired.js</code>，内容如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;theme_inject&#x27;</span>, <span class="hljs-function"><span class="hljs-params">injects</span> =&gt;</span> &#123;<br>  injects.<span class="hljs-property">postMarkdownBegin</span>.<span class="hljs-title function_">file</span>(<br>    <span class="hljs-string">&#x27;expired-warning&#x27;</span>,<br>    <span class="hljs-string">&#x27;source/_inject/expired-warning.ejs&#x27;</span><br>  );<br>&#125;);<br></code></pre></td></tr></table></figure><p>真正显示提示的内容放在一个独立的 EJS 模板中，位于<code>source/_inject</code>目录。</p><p>新建文件<code>expired-warning.ejs</code>内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;%<br>  // 当前时间<br>  const now = new Date();<br><br>  // 文章发布时间（来自 front-matter 的 date）<br>  const postDate = new Date(page.date);<br><br>  // 相差毫秒<br>  const diffTime = now - postDate;<br><br>  // 相差天数<br>  const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));<br><br>  // 年 / 天拆分<br>  const years = Math.floor(diffDays / 365);<br>  const days = diffDays % 365;<br><br>  // 显示用文本<br>  let ageText = &#x27;&#x27;;<br>  if (years &gt; 0) &#123;<br>    ageText = `$&#123;years&#125; 年 $&#123;days&#125; 天`;<br>  &#125; else &#123;<br>    ageText = `$&#123;diffDays&#125; 天`;<br>  &#125;<br><br>  // 是否显示过期提示<br>  const expireDate = page.expire_date ? new Date(page.expire_date) : null;<br>  const showExpired =<br>    diffDays &gt; 0 &amp;&amp;<br>    (page.expired || (expireDate &amp;&amp; now &gt; expireDate));<br>%&gt;<br><br>&lt;% if (showExpired) &#123; %&gt;<br>  &lt;div class=&quot;post-expired-warning&quot;&gt;<br>    这是一篇发布于<br>    &lt;strong&gt;&lt;%= ageText %&gt;&lt;/strong&gt;<br>    前的文章，部分信息可能已发生改变，请注意甄别。<br>  &lt;/div&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure><p>这个模板主要做了几件事：</p><ul><li>从 page.date 读取文章发布时间  </li><li>获取当前构建时间  </li><li>计算两者之间相差的天数  </li><li>将天数拆分为「年 + 天」的形式  </li><li>根据 expired 或 expire_date 判断是否需要显示</li></ul><p>当文章发布时间不足一天时，不显示提示，避免出现「0 天前」这种无意义信息。</p>]]></content>
    
    
    
    <tags>
      
      <tag>教程</tag>
      
      <tag>Fluid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo Fluid 实现日夜模式 Banner 图片切换</title>
    <link href="/posts/5665d9c4/"/>
    <url>/posts/5665d9c4/</url>
    
    <content type="html"><![CDATA[<p>在使用 Hexo 的 Fluid 主题时，我参考了<a href="https://4rozen.github.io/posts/60191.html">这篇文章</a>来实现<strong>日夜模式切换 Banner 图片</strong></p><p>原方案思路是对的，也能跑通，但在实际使用中我遇到了两个<strong>明显痛点</strong>：</p><ol><li><strong>首页默认被排除，无法切换 Banner 图片</strong></li><li><strong>直接删除遮罩（mask）后，视觉效果很丑</strong></li></ol><p>本文记录我针对这两个问题的解决方案，供同样使用 Fluid 主题的朋友参考。</p><h2 id="一、原方案的问题分析"><a href="#一、原方案的问题分析" class="headerlink" title="一、原方案的问题分析"></a>一、原方案的问题分析</h2><h3 id="问题-1：首页不支持切换-Banner"><a href="#问题-1：首页不支持切换-Banner" class="headerlink" title="问题 1：首页不支持切换 Banner"></a>问题 1：首页不支持切换 Banner</h3><p>原文中通过一个 <code>isExcludedPage</code> 方法来判断是否启用日夜切换逻辑</p><p>而在默认逻辑里，<strong>首页 <code>/</code>是被排除的</strong>，也就是说首页不执行切换</p><p>这对我来说是不可接受的，因为首页 Banner 恰恰是最需要日夜区分的地方。</p><h3 id="问题-2：直接移除遮罩，画面观感很差"><a href="#问题-2：直接移除遮罩，画面观感很差" class="headerlink" title="问题 2：直接移除遮罩，画面观感很差"></a>问题 2：直接移除遮罩，画面观感很差</h3><p>原方案中对 Banner 遮罩的处理方式是直接将遮罩透明化</p><p>这样做的结果是：</p><ul><li><p>图片亮度失控</p></li><li><p>字体对比度不足</p></li><li><p>页面“素”得很明显</p></li></ul><p><strong>遮罩不该被移除，而应该被“设计”</strong></p><h2 id="二、问题一的解决：让首页参与日夜切换"><a href="#二、问题一的解决：让首页参与日夜切换" class="headerlink" title="二、问题一的解决：让首页参与日夜切换"></a>二、问题一的解决：让首页参与日夜切换</h2><p>对<code>backgroundize.js</code>的<code>isExcludedPage</code>方法做小修改：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">isExcludedPage</span> = (<span class="hljs-params">path</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (path === <span class="hljs-string">&quot;/&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// true改为false启用首页切换</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">PAGE_EXCLUSIONS</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">excluded</span>) =&gt;</span> path.<span class="hljs-title function_">startsWith</span>(excluded));<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="修改效果"><a href="#修改效果" class="headerlink" title="修改效果"></a>修改效果</h3><table><thead><tr><th>页面</th><th>是否参与日夜切换</th></tr></thead><tbody><tr><td>首页</td><td>✅</td></tr><tr><td>文章页</td><td>✅</td></tr><tr><td>排除页</td><td>❌</td></tr></tbody></table><h2 id="三、问题二的解决：用渐变遮罩代替“删除遮罩”"><a href="#三、问题二的解决：用渐变遮罩代替“删除遮罩”" class="headerlink" title="三、问题二的解决：用渐变遮罩代替“删除遮罩”"></a>三、问题二的解决：用渐变遮罩代替“删除遮罩”</h2><p>相比 CSS 覆盖，我选择了 直接用 <code>JavaScript</code> 接管遮罩层样式，这是目前在 Fluid 中最稳定的方案。</p><p>核心思路是将纯色遮罩改为渐变透明遮罩</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">removeBannerMask</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> mask = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#banner .mask&quot;</span>);<br>  <span class="hljs-keyword">if</span> (!mask) <span class="hljs-keyword">return</span>;<br><br>  mask.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">`</span><br><span class="hljs-string">    linear-gradient(</span><br><span class="hljs-string">      to bottom,</span><br><span class="hljs-string">      rgba(0, 0, 0, 0.6) 0%,</span><br><span class="hljs-string">      rgba(0, 0, 0, 0.35) 40%,</span><br><span class="hljs-string">      rgba(0, 0, 0, 0.15) 70%,</span><br><span class="hljs-string">      rgba(0, 0, 0, 0) 100%</span><br><span class="hljs-string">    )</span><br><span class="hljs-string">  `</span>;<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>教程</tag>
      
      <tag>Fluid</tag>
      
      <tag>日夜模式</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>林泽凯的小站-正在建设中</title>
    <link href="/posts/332d3c8b/"/>
    <url>/posts/332d3c8b/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hexo Fluid 一言中添加作者</title>
    <link href="/posts/f88aa2a0/"/>
    <url>/posts/f88aa2a0/</url>
    
    <content type="html"><![CDATA[<p>目前，fluid主题的一言还不支持默认添加作者，所以我们需要修改首页打字机的代码。</p><p>1.打开<strong>主题</strong>根目录下的<code>layout\_partial\plugins</code>文件夹，修改其中的<code>typed.ejs</code>文件</p><p>2.找到以下语句</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">apiText ? <span class="hljs-title function_">typing</span>(apiText) : <span class="hljs-title function_">typing</span>(text);<br></code></pre></td></tr></table></figure><p>加入出处可在<code>typing(apiText)</code>中加入相应代码，示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">apiText ? <span class="hljs-title function_">typing</span>(<span class="hljs-string">&#x27;『&#x27;</span>+apiText+<span class="hljs-string">&#x27;』&#x27;</span>+ <span class="hljs-string">&#x27;&lt;br /&gt; &lt;h4&gt;&#x27;</span>+ <span class="hljs-string">&#x27;--&#x27;</span> +result[<span class="hljs-string">&#x27;from_who&#x27;</span>]+<span class="hljs-string">&#x27;「&#x27;</span>+result[<span class="hljs-string">&#x27;from&#x27;</span>]+<span class="hljs-string">&#x27;」&#x27;</span>+<span class="hljs-string">&#x27;&lt;/h4&gt;&#x27;</span>) : <span class="hljs-title function_">typing</span>(text);<br></code></pre></td></tr></table></figure><p>显示效果：</p><blockquote><p>『猫是可爱的，狼是很帅的。就是说，孤独又可爱又帅。』<br>–比企谷八幡「我的青春恋爱物语果然有问题」</p></blockquote><p>3.有一些一言并没有设置作者，此时typing会出现这样的情况</p><blockquote><p>『不要在晚上做出任何决定。』<br>–null「互联网」</p></blockquote><p>强迫症落泪。不过还是有解决办法的，我们可以在他的上方添加一个判断，如果<code>result[&#39;from_who&#39;]</code>的值为<code>null</code>，那么替换为空字符。</p><p>在步骤二修改的语句上方添加：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span>(result[<span class="hljs-string">&#x27;from_who&#x27;</span>]===<span class="hljs-literal">null</span>) result[<span class="hljs-string">&#x27;from_who&#x27;</span>]=<span class="hljs-string">&#x27;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>显示效果：</p><blockquote><p>『不要在晚上做出任何决定。』<br>–「互联网」</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>教程</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>希沃冰点还原忘记密码的解决方案</title>
    <link href="/posts/786d78c9/"/>
    <url>/posts/786d78c9/</url>
    
    <content type="html"><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>学校电脑教室使用的WPS经常弹出升级弹窗，影响正常教学，因此决定改用微软Office。但负责老师不愿告知电教设备的还原卡密码,于是自己动手那个丰衣足食。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="第一步：降级希沃管家"><a href="#第一步：降级希沃管家" class="headerlink" title="第一步：降级希沃管家"></a>第一步：降级希沃管家</h3><p>新版希沃管家的加密方式有所改变，需要先降级到旧版本：</p><p><strong>下载链接：</strong> <a href="https://appdown.naierchina.com/appfile1/appfileup01/file2/20200819/SeewoServiceSetup_1.1.9.2219.exe">希沃管家旧版安装包</a></p><p>直接运行降级安装包，它会自动覆盖安装（无需密码）！</p><blockquote><p><strong>注意：</strong> 如果按转结束后<strong>不要点重启</strong>，不然你的希沃管家版本又回去了。</p></blockquote><h3 id="第二步：查找还原密码"><a href="#第二步：查找还原密码" class="headerlink" title="第二步：查找还原密码"></a>第二步：查找还原密码</h3><ol><li>进入希沃管家的数据目录：<code>C:\ProgramData\Seewo\SeewoCore</code></li></ol><p><img src="https://pic1.zhimg.com/80/v2-68960eafe5cf5b8b2dfd3f5102689e0e_1440w.webp" alt="鼠标批注的，各位轻喷"></p><p>（ProgramData文件夹默认是隐藏的，需要在文件夹选项中开启”显示隐藏文件”）</p><ol start="2"><li><p>找到并打开 <code>SeewoCore.ini</code> 文件</p></li><li><p>在文件中找到一串32位的字符：</p></li></ol><p><img src="https://picx.zhimg.com/80/v2-ea3b90dd04333287cf79429579f5f8a5_1440w.webp" alt="配置文件中的密码"></p><ol start="4"><li>这串32位字符实际上是MD5加密后的密码，需要解密：</li></ol><ul><li>访问MD5解密网站（如：cmd5.com）</li><li>输入这串32位密文</li><li>得到6位数字密码</li></ul><p><img src="https://picx.zhimg.com/80/v2-cb21ee3560d5ccf1dbc9f771068466d4_1440w.webp" alt="MD5解密结果"></p><h3 id="第三步：成功"><a href="#第三步：成功" class="headerlink" title="第三步：成功"></a>第三步：成功</h3><p>获取密码后，就可以正常卸载希沃管家或修改设置了：</p><p><img src="https://pic1.zhimg.com/80/v2-462f224ab32ab5b94b09d2c44e178f40_1440w.webp" alt="成功界面"></p><hr><blockquote><p><strong>温馨提示：</strong> 此方法仅供解决实际使用中的困难，请勿用于非法用途。</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>教程</tag>
      
      <tag>希沃</tag>
      
      <tag>冰点还原</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
