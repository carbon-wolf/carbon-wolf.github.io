(function(){function t(e,t,r){"use strict";var a=jQuery(t);var l=jQuery(r);if(a.length===0){throw Error("No element selected by the searchSelector")}if(l.length===0){throw Error("No element selected by the resultSelector")}if(l.attr("class").indexOf("list-group-item")===-1){l.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>')}jQuery.ajax({url:e,dataType:"xml",success:function(e){var t=jQuery("entry",e).map(function(){return{title:jQuery("title",this).text(),content:jQuery("content",this).text(),url:jQuery("url",this).text()}}).get();if(l.html().indexOf("list-group-item")===-1){l.html("")}a.on("input",function(){var e=a.val();var d="";var m=e.trim().toLowerCase().split(/[\s-]+/);l.html("");if(e.trim().length<=0){return a.removeClass("invalid").removeClass("valid")}t.forEach(function(e){var r=true;if(!e.title||e.title.trim()===""){e.title="Untitled"}var t=e.title.trim();var a=t.toLowerCase();var l=e.content.trim().replace(/<[^>]+>/g,"");var i=l.toLowerCase();var s=e.url;var n=-1;var o=-1;var c=-1;if(CONFIG.include_content_in_search&&i===""){r=false}else{m.forEach(function(e,t){n=a.indexOf(e);o=i.indexOf(e);if(n<0&&o<0){r=false}else{if(o<0){o=0}if(t===0){c=o}}})}if(r){d+="<a href='"+s+"' class='list-group-item list-group-item-action font-weight-bolder search-list-title'>"+t+"</a>";var u=l;if(c>=0){var v=c-20;var h=c+80;if(v<0){v=0}if(v===0){h=100}if(h>u.length){h=u.length}var f=u.substring(v,h);m.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<span class="search-word">'+e+"</span>")});d+="<p class='search-list-content'>"+f+"...</p>"}}});if(d.indexOf("list-group-item")===-1){return a.addClass("invalid").removeClass("valid")}a.addClass("valid").removeClass("invalid");l.html(d)})}})}function e(e,t){"use strict";var r=jQuery(e);var a=jQuery(t);if(r.length===0){throw Error("No element selected by the searchSelector")}if(a.length===0){throw Error("No element selected by the resultSelector")}r.val("").removeClass("invalid").removeClass("valid");a.html("")}var r=jQuery("#modalSearch");var a="#local-search-input";var l="#local-search-result";r.on("show.bs.modal",function(){var e=CONFIG.search_path||"/local-search.xml";t(e,a,l)});r.on("shown.bs.modal",function(){jQuery("#local-search-input").focus()});r.on("hidden.bs.modal",function(){e(a,l)})})();